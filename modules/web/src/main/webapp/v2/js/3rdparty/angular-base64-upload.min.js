!function(e){"use strict";e._arrayBufferToBase64=function(n){for(var r="",a=new Uint8Array(n),i=a.byteLength,t=0;i>t;t++)r+=String.fromCharCode(a[t]);return e.btoa(r)};var n=e.angular.module("base64",[]);n.directive("baseSixtyFourInput",["$window","$q",function(e,n){for(var r={onChange:"&",parser:"&"},a=["onabort","onerror","onloadstart","onloadend","onprogress","onload"],i=a.length-1;i>=0;i--){var t=a[i];r[t]="&"}return{restrict:"A",require:"?ngModel",scope:r,link:function(r,i,t,o){function s(e,n,r,a,i){r[e]=function(e){n()(e,r,a,h,$,i)}}function l(a,i,o){return function(s){var l,u=s.target.result;o.raw=new Int8Array(u);o.base64=e._arrayBufferToBase64(u),l=n.when(t.parser?r.parser()(i,o):o),l.then(function(e){$.push(e),f()}),t.onload&&r.onload()(s,a,i,h,$,o)}}function u(e,n,i){for(var o=a.length-1;o>=0;o--){var u=a[o];t[u]&&"onload"!==u&&s(u,r[u],e,n,i)}e.onload=l(e,n,i)}function f(){var e=t.multiple?$:$[0];o.$setViewValue(e),angular.isFunction(o.$validate)&&o.$validate();var n=angular.version.full.split(".");if("1"===n[0]&&"3"===n[1]&&parseInt(n[2])>=4){var r=o.$viewValue;g(r),d(r),v(r),c(r)}}function p(){for(var n=h.length-1;n>=0;n--){var r=new e.FileReader,a=h[n],i={};i.filetype=a.type,i.filename=a.name,i.filesize=a.size,u(r,a,i),r.readAsArrayBuffer(a)}}function m(e){t.onChange&&r.onChange()(e,h)}function v(e){if(t.maxnum&&t.multiple&&e){var n=e.length<=parseInt(t.maxnum);o.$setValidity("maxnum",n)}return e}function c(e){if(t.minnum&&t.multiple&&e){var n=e.length>=parseInt(t.minnum);o.$setValidity("minnum",n)}return e}function g(e){var n=!0;if(t.maxsize&&e){var r=1e3*parseFloat(t.maxsize);if(t.multiple)for(var a=0;a<e.length;a++){var i=e[a];if(i.filesize>r){n=!1;break}}else n=e.filesize<=r;o.$setValidity("maxsize",n)}return e}function d(e){var n=!0,r=1e3*parseFloat(t.minsize);if(t.minsize&&e){if(t.multiple)for(var a=0;a<e.length;a++){var i=e[a];if(i.filesize<r){n=!1;break}}else n=e.filesize>=r;o.$setValidity("minsize",n)}return e}if(o){o.$setViewValue(null),o.$setPristine();var h=[],$=[];i.on("change",function(e){e.target.files.length&&($=[],$=angular.copy($),h=e.target.files,p(),m(e))}),o.$parsers.push(v),o.$parsers.push(c),o.$parsers.push(g),o.$parsers.push(d)}}}}])}(window);